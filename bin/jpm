#!/bin/bash

# Wrapper around maven to always save the output.  

JPR_MAVEN_OUTPUT_FILE="${JPR_MAVEN_OUTPUT_FILE:-.jpr/maven.out}"

MVNCMD=/usr/local/bin/mvn

alert_sound='Glass'

echo "$MVNCMD $@"
$MVNCMD $@ | tee $JPR_MAVEN_OUTPUT_FILE
mvnstatus=${PIPESTATUS[0]}
[[ $mvnstatus -eq 1 ]] && alert_sound='Basso'
module=$(basename $(pwd))
terminal-notifier -message "$MVNCMD $(echo $@ | sed 's/-/\-/g')" -title "$module build finished" -group "$module: jpr build" -sound $alert_sound
